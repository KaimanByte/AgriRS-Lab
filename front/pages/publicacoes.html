<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Publica√ß√µes - AgriRSlab</title>
  <link rel="stylesheet" href="../styles/stylePublicacoes.css">
  <link rel="stylesheet" href="../styles/StyleHeader.css">
  <link rel="stylesheet" href="../styles/StyleFooter.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Lexend:wght@100..900&display=swap" rel="stylesheet">
</head>

<body>
  <div id="footer-brasil">
    <div id="barra-brasil" style="background:#7F7F7F; height: 20px; padding:0 0 0 10px;display:block;">
      <ul id="menu-barra-temp" style="list-style:none;">
        <li style="display:inline; float:left;padding-right:10px; margin-right:10px; border-right:1px solid #EDEDED">
          <a href="http://brasil.gov.br" style="font-family:sans,sans-serif; text-decoration:none; color:white;">Portal
            do Governo Brasileiro</a>
        </li>
        <li>
          <a style="font-family:sans,sans-serif; text-decoration:none; color:white;" href="http://epwg.governoeletronico.gov.br/barra/atualize.html">Atualize sua Barra de Governo</a>
        </li>
      </ul>
    </div>
  </div>
  <header>
    <nav>
      <img src="../imagens/Header/AgriRSlab.png" id="Agriheader">

      <!-- üîπ Bot√£o do menu hamb√∫rguer adicionado -->
      <button id="menu-toggle" aria-label="Abrir menu">‚ò∞ Menu</button>

      <ul id="nav-links">
        <li><a href="index.html">In√≠cio</a></li>
        <li><a href="sobre.html">Sobre</a></li>
        <li><a href="vagas.html">Vagas</a></li>
        <li><a href="membros.html">Membros</a></li>
        <li><a href="projetos.html">Projetos</a></li>
        <li><a href="noticias.html">Not√≠cias</a></li>
        <li><a href="publicacoes.html" class="ativo">Publica√ß√µes</a></li>
        <li><a href="contato.html">Contato</a></li>
      </ul>
      <img src="../imagens/Header/Inpe.png" id="Inpeheader">
    </nav>
  </header>

  <div id="imagemFundo">Publica√ß√µes</div>

  <!-- Barra de pesquisa e filtros -->
  <section class="pesquisa">
    <h2 class="titulo-academico">Acompanhe nossos trabalhos acad√™micos</h2>
    <div class="pesquisa2">
      <input type="text" placeholder="Pesquise">
      <button class="search-btn" aria-label="Pesquisar">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="black" stroke-linecap="round"
          stroke-linejoin="round">
          <circle cx="11" cy="11" r="8"></circle>
          <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
        </svg>
      </button>
    </div>
  </section>
  
    <ul id="lista"></ul>
  </section>

  <!-- Lista de publica√ß√µes -->
  <main>
    <!-- substitui os artigos est√°ticos por um container que ser√° preenchido dinamicamente -->
    <section class="lista-publicacoes" id="publicacoes-container">
      <!-- cards ser√£o inseridos aqui dinamicamente -->
    </section>
  </main>

  <footer>
    <div id="footer-brasil"></div>
    <block>
      <div id="divOne">
        <img src="../imagens/Footer/AgriRSlab.png" id="AgriRSfooter" alt="AgriRSlab">
        <div id="textolado">
          <div class="titulo24">AgriRSlab</div>
          <div class="texto16">Laborat√≥rio de Sensoriamento Remoto Agr√≠cola</div>
        </div>
      </div>

      <div id="divTwo">
        <div>
          <img id="iconeMapa" src="../imagens/Footer/iconeMapa.png" alt="Mapa">
          <span class="texto16">Av. dos Astronautos, 1,758 - S√£o Jos√© dos Campos - SP, 12227-010</span>
        </div>
        <div>
          <img id="iconeTelefone" src="../imagens/Footer/iconeTelefone.png" alt="Telefone">
          <span class="texto16">+55 (12) 3208-6000</span>
        </div>
      </div>

      <div id="redesSociais">
        <a target="_blank" title="X/Twitter" href="https://x.com/agrirs_lab?lang=pt">
          <img src="../imagens/Footer/xIcone.png" alt="X/Twitter">
        </a>
        <a target="_blank" title="LinkedIn" href="https://www.linkedin.com/company/agrirslab">
          <img src="../imagens/Footer/linkedinIcone.png" alt="LinkedIn">
        </a>
        <a target="_blank" title="GitHub" href="https://github.com/agrirslab">
          <img src="../imagens/Footer/githubIcone.png" alt="GitHub">
        </a>
        <a target="_blank" title="ResearchGate" href="https://www.researchgate.net/lab/AgriRS-Lab-Ieda-Sanches">
          <img src="../imagens/Footer/researchGateIcone.png" alt="ResearchGate">
        </a>
      </div>
    </block>

    <div class="foraLinha">
      <div class="linha"></div>
    </div>

    <block>
      <div id="divThree">
        <div class="titulo24">Sobre</div>
        <ul class="texto16">
          <li><a href="#">O AgriRSlab</a></li>
          <li><a href="#">Nossa equipe</a></li>
          <li><a href="#">Colaboradores</a></li>
          <li><a href="#">Oportunidades</a></li>
        </ul>
      </div>
    </block>

    <div class="foraLinha">
      <div class="linha"></div>
    </div>

    <block>
      <div id="divFour">
        <div class="titulo24">Atua√ß√£o</div>
        <ul class="texto16">
          <li><a href="#">√Årea de Pesquisa</a></li>
          <li><a href="#">Projetos</a></li>
          <li><a href="#">Servi√ßos</a></li>
          <li><a href="#">Parcerias</a></li>
        </ul>
      </div>
    </block>

    <div class="foraLinha">
      <div class="linha"></div>
    </div>

    <block>
      <div id="divFive">
        <div class="titulo24">Colaboradores</div>
        <div>
          <a target="_blank" title="Inpe" href="https://www.gov.br/inpe/pt-br">
            <img src="../imagens/Footer/Inpe.png" id="InpeFooter" alt="Inpe">
          </a>
          <a target="_blank" title="FAPESP" href="https://fapesp.br">
            <img src="../imagens/Footer/FAPESP.png" id="FapespFooter" alt="FAPESP">
          </a>
          <a target="_blank" title="Brazil Data Cube" href="https://data.inpe.br/bdc">
            <img src="../imagens/Footer/Bdc.png" id="BdcFooter" alt="Brasil Data Cube">
          </a>
        </div>
        <div id="colaboradores2">
          <a target="_blank" title="CAPES" href="https://www.gov.br/capes/pt-br">
            <img src="../imagens/Footer/CAPES.png" id="CapesFooter" alt="CAPES">
          </a>
          <a target="_blank" title="CNPq" href="https://www.gov.br/cnpq/pt-br">
            <img src="../imagens/Footer/CNPq.png" id="CnpqFooter" alt="CNPq">
          </a>
          <a target="_blank" title="Conab" href="https://www.gov.br/conab/pt-br">
            <img src="../imagens/Footer/Conab.png" id="ConabFooter" alt="Conab">
          </a>
        </div>
      </div>
    </block>
  </footer>

  <script>
    const criterio = document.getElementById("criterio");
    const btnFiltrar = document.getElementById("btnFiltrar");
    const btnLimpar = document.getElementById("btnLimpar");

    btnFiltrar.addEventListener("click", () => {
      if (criterio.value) {
        alert(`Filtrando publica√ß√µes por: ${criterio.value}`);
      } else {
        alert("Selecione um crit√©rio para filtrar.");
      }
    });

    btnLimpar.addEventListener("click", () => {
      criterio.value = "";
      alert("Filtros limpos!");
    });
  </script>

  <script>
    const toggle = document.getElementById("menu-toggle");
    const navLinks = document.getElementById("nav-links");
    const navItems = document.querySelectorAll("#nav-links a");

      toggle.addEventListener("click", () => {
        navLinks.classList.toggle("ativo");
      });

      // Fecha o menu ao clicar em um link (melhor UX)
      navItems.forEach((item) => {
        item.addEventListener("click", () => {
          navLinks.classList.remove("ativo");
        });
      });
    </script>

  <script>
  const API = "http://localhost:3030/publicacao";
  let PUBLICACOES = {};

  function formatDate(v) {
    if (!v) return "-";
    const d = new Date(v);
    if (isNaN(d)) return v;
    return d.toLocaleString('pt-BR');
  }

  function renderPublicacoesCards() {
    const container = document.getElementById("publicacoes-container");
    container.innerHTML = "";
    const pubs = Object.values(PUBLICACOES);
    if (!pubs || pubs.length === 0) {
      container.innerHTML = '<p class="mensagem">Nenhuma publica√ß√£o dispon√≠vel.</p>';
      return;
    }

    pubs.forEach(pub => {
      const art = document.createElement("article");
      art.className = "publicacao card";
      art.innerHTML = `
        <img src="${pub.imagem_url || '/imagens/Publicacoes/pb01.png'}" alt="${(pub.titulo || '').replace(/"/g,'')}" />
        <h3>${pub.titulo || ''}</h3>
        <p>${pub.descricao || ''}</p>
        <div class="botoes">
          ${pub.pdf_url ? `<a href="${pub.pdf_url}" target="_blank" rel="noopener">PDF</a>` : ''}
          ${pub.citacao_url ? `<a href="${pub.citacao_url}" target="_blank" rel="noopener">Cita√ß√£o</a>` : ''}
          ${pub.doi_url ? `<a href="${pub.doi_url}" target="_blank" rel="noopener">DOI</a>` : ''}
        </div>
        <small class="timestamps">Criado: ${formatDate(pub.criado_em)} ‚Ä¢ Atualizado: ${formatDate(pub.atualizado_em)}</small>
      `;
      container.appendChild(art);
      art.dataset.displayOriginal = getComputedStyle(art).display || "block";
    });
  }

  function renderListaLateral() {
    const lista = document.getElementById("lista");
    lista.innerHTML = "";
    const pubs = Object.values(PUBLICACOES);
    if (!pubs || pubs.length === 0) {
      lista.innerHTML = '<li class="mensagem">Nenhuma publica√ß√£o dispon√≠vel.</li>';
      return;
    }

    
  }

  function carregar() {
    fetch(API)
      .then(r => r.json())
      .then(data => {
        PUBLICACOES = {};
        data.forEach(pub => {
          PUBLICACOES[pub.idpublicacao] = pub;
        });
        renderListaLateral();
        renderPublicacoesCards();
      })
      .catch(err => {
        console.error('Erro ao carregar publica√ß√µes:', err);
        document.getElementById("lista").innerHTML = '<li class="mensagem">Erro ao carregar publica√ß√µes.</li>';
        document.getElementById("publicacoes-container").innerHTML = '<p class="mensagem">Erro ao carregar publica√ß√µes.</p>';
      });
  }

  // Filtro de busca para os cards principais
  document.addEventListener("DOMContentLoaded", function () {
    const searchInput = document.querySelector(".pesquisa2 input");
    searchInput.addEventListener("input", function () {
      const termo = searchInput.value.toLowerCase().trim();
      const cards = document.querySelectorAll(".lista-publicacoes .card");
      cards.forEach(card => {
        const displayOriginal = card.dataset.displayOriginal || "block";
        const textoCard = card.textContent.toLowerCase();
        card.style.display = termo === "" || textoCard.includes(termo) ? displayOriginal : "none";
      });
    });

    carregar();
  });
</script>

  <script defer src="https://barra.brasil.gov.br/barra.js" type="text/javascript"></script>
</body>

</html>